<!DOCTYPE html>

<html>
  <head>
    <script src='./javascripts/sas/util/messagingUtil.js'></script>
    <script src="./javascripts/jquery/jquery.min.js"></script>

     <script type="text/javascript">
                "use strict";

                // Declare datareceive event handler from VA visualizations
        va.messagingUtil.setOnDataReceivedCallback(onDataReceived);
                // Event handler used upper : retrieve three value from the report, resource Id respectively

		function convertToTimestamp(dateString) {  
		    // Create a new Date object by parsing the input string  
		    let date = new Date(dateString);  
		  
		    // Ensure that the date object is valid  
		    if (isNaN(date.getTime())) {  
		        throw new Error("Invalid date format");  
		    }  
		  
		    // Format the date components  
		    let year = date.getFullYear();  
		    let month = String(date.getMonth() + 1).padStart(2, '0'); // Months are zero-based  
		    let day = String(date.getDate()).padStart(2, '0');  
		  
		    // Construct the timestamp string  
		    let formattedTimestamp = `${year}-${month}-${day} 00:00:00`;  
		  
		    return formattedTimestamp;  
		}  
  


        function onDataReceived(resultData)
        {
            // Role 1 : uri source object
            document.getElementById('mainForm').elements['entity_type'].value = resultData.data[0][0];
			document.getElementById('mainForm').elements['decision_flow'].value = resultData.data[0][1];
			document.getElementById('mainForm').elements['decision_rule'].value = resultData.data[0][2];
			document.getElementById('mainForm').elements['reference_date'].value = convertToTimestamp(resultData.parameters[4]['value']);
            document.getElementById('mainForm').elements['acc_type_list'].value = resultData.data[0][4];	
			document.getElementById('mainForm').elements['lookback_months'].value = resultData.parameters[0]['value'];
			document.getElementById('mainForm').elements['min_total_trans_amount'].value = resultData.parameters[1]['value'];
			document.getElementById('mainForm').elements['value_for_scoring'].value = resultData.parameters[2]['value'];
            document.getElementById('mainForm').elements['velocity_factor'].value = resultData.parameters[3]['value'];

			
            }
     </script>

     <meta charset="utf-8" http-equiv="X-UA-Compatible" content="IE=edge" />
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
    </head>

    <!DOCTYPE html>

    <body>
        <div class="container-fluid" style="text-align: center; margin-top: 0px;">  
	<form id="mainForm" action="/SASJobExecution/" enctype="multipart/form-data">
        <input type="hidden" name="_program" value="/Public/SIMU/simu_central_v2">
        <input type="hidden" name="entity_type" id="entity_type">
		<input type="hidden" name="decision_flow" id="decision_flow">
		<input type="hidden" name="decision_rule" id="decision_rule">
		<input type="hidden" name="reference_date" id="reference_date">
		<input type="hidden" name="acc_type_list" id="acc_type_list">
        <input type="hidden" name="lookback_months" id="lookback_months">
		<input type="hidden" name="min_total_trans_amount" id="min_total_trans_amount">
        <input type="hidden" name="value_for_scoring" id="value_for_scoring">
        <input type="hidden" name="velocity_factor" id="velocity_factor">

		<label>
		
	
        <input type="hidden" name="_action" value="wait">
		<input type="submit" class="btn btn-primary" value="Click to proceed" />
        	<br>   
	</form>
        </div>
    </body>
	
</html>

